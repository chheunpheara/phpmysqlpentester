<?php

namespace controller;


class FileController {

    public function remote($file = null) {
        // If allow_url_include = On
        if (isset($file)) {
            if (! filter_var($file, FILTER_VALIDATE_URL)) die('Not valid file url');
            require_once($file);
        } else {
            echo '<h3>Remote File Inclusion</h3>';
            echo '<p>The remote file inclusion will be successfully launched in this context and `allow_url_include=On` in `php.ini`. If `allow_url_include=Off`, the attack will not work.</p>';
            echo '<p>Start test local file <a href=\'?page=file&route=remote&file=upload.php\'>here</a></p>';
            echo '<p>Or input your file url below:</p>';
            echo '<form method=\'POST\'>';
            echo '<input type=\'text\' name=\'url\'>';
            echo '<input type=\'submit\' value=\'Go\'>';

            if (isset($_POST['url'])) {
                $url = $_POST['url'];
                header('Location: ?page=file&route=remote&file=' . $url);
            }
        }
    }
}